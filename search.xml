<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>zookeeperé›†æˆseata</title>
      <link href="/2022/01/02/1/"/>
      <url>/2022/01/02/1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å› ä¸ºä¸å–œæ¬¢nacosï¼Œå¤ªå¤§å¾ˆè‡ƒè‚¿å¾ˆå¤šåŠŸèƒ½æ²¡å¿…è¦ï¼Œæ‰€ä»¥ä½¿ç”¨æ³¨å†Œä¸­å¿ƒå’Œé…ç½®ä¸­å¿ƒå‡ä¸ºzookeeperï¼Œç„¶ååŸºäºzookeeperæ­å»ºäº†ä¸€ä¸ªåç«¯å¾®æœåŠ¡è„šæ‰‹æ¶ã€‚çŠ¯è ¢å¿˜äº†ä¸åŒæœåŠ¡ç”¨çš„æ˜¯ä¸åŒæ•°æ®åº“ï¼Œä½†æ˜¯è‡ªå·±æµ‹è¯•çš„æ—¶å€™å·æ‡’åªç”¨äº†ä¸€ä¸ªæ•°æ®åº“ï¼Œå¯¼è‡´åˆ†å¸ƒå¼äº‹åŠ¡å§‹ç»ˆä¸ç”Ÿæ•ˆï¼Œåæ¥æ‹†åˆ†æ•°æ®åº“ï¼Œæµ‹è¯•æ­£å¸¸ã€‚zookeeperæ¨èä½¿ç”¨ZK UIå¯¼å…¥é…ç½®æ–‡ä»¶ã€‚å¦åœ¨Seata 1.4.2ç‰ˆæœ¬ä¸­æ•°æ®åº“ä¸­æ—¶é—´å­—æ®µä¸èƒ½ä½¿ç”¨datetimeç±»å‹å¦åˆ™ä¼šå¼•èµ·åºåˆ—åŒ–é”™è¯¯ã€‚</p></blockquote><h4 id="1-å¼•å…¥ä¾èµ–"><a href="#1-å¼•å…¥ä¾èµ–" class="headerlink" title="1.å¼•å…¥ä¾èµ–"></a>1.å¼•å…¥ä¾èµ–</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-starter-zookeeper-config --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-cloud-starter-zookeeper-config&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.1.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-starter-zookeeper-discovery --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-cloud-starter-zookeeper-discovery&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.1.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- seataè¿æ¥zk é»˜è®¤è¿æ¥å™¨ï¼Œä¸å‰”é™¤å°±ç‹‚æŠ¥é”™ --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.101tec&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;zkclient&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;0.11&lt;/version&gt;</span><br><span class="line">    &lt;exclusions&gt;</span><br><span class="line">        &lt;exclusion&gt;</span><br><span class="line">            &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;zookeeper&lt;/artifactId&gt;</span><br><span class="line">        &lt;/exclusion&gt;</span><br><span class="line">    &lt;/exclusions&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- seata --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.seata&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;seata-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.4.2&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h4 id="2-ç¼–å†™consumerå’Œproviderçš„yml"><a href="#2-ç¼–å†™consumerå’Œproviderçš„yml" class="headerlink" title="2.ç¼–å†™consumerå’Œproviderçš„yml"></a>2.ç¼–å†™consumerå’Œproviderçš„yml</h4><h5 id="æ¶ˆè´¹è€…"><a href="#æ¶ˆè´¹è€…" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: consumer</span><br><span class="line">  profiles:</span><br><span class="line">    active: dev # ä¸æŒ‡å®šè¿™ä¸ªå‚æ•°åœ¨ä½¿ç”¨zookeeperä½œä¸ºé…ç½®ä¸­å¿ƒä¼šæŠ¥é”™</span><br><span class="line">  cloud:</span><br><span class="line">    zookeeper:</span><br><span class="line">      enabled: true  # true:å¼€å¯zookeeperå¤–éƒ¨åŒ–é…ç½®, false:è¯»å–æœ¬åœ°é…ç½®; éœ€è¦å°†config.watcher.enabledåŒæ—¶è®¾ç½®</span><br><span class="line">      connect-string: 127.0.0.1:2181</span><br><span class="line">      discovery:</span><br><span class="line">        register: true</span><br><span class="line">        enabled: true</span><br><span class="line">        root: /cloud-service</span><br><span class="line">      config:</span><br><span class="line">        enabled: true</span><br><span class="line">        root: /cloud-config</span><br><span class="line">        watcher:</span><br><span class="line">          enabled: true</span><br></pre></td></tr></table></figure><h5 id="æä¾›è€…"><a href="#æä¾›è€…" class="headerlink" title="æä¾›è€…"></a>æä¾›è€…</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: provider</span><br><span class="line">  profiles:</span><br><span class="line">    active: dev</span><br><span class="line">  cloud:</span><br><span class="line">    zookeeper:</span><br><span class="line">      enabled: true  # true:å¼€å¯zookeeperå¤–éƒ¨åŒ–é…ç½®, false:è¯»å–æœ¬åœ°é…ç½®; éœ€è¦å°†config.watcher.enabledåŒæ—¶è®¾ç½®</span><br><span class="line">      connect-string: 127.0.0.1:2181</span><br><span class="line">      discovery:</span><br><span class="line">        register: true</span><br><span class="line">        enabled: true</span><br><span class="line">        root: /cloud-service</span><br><span class="line">      config:</span><br><span class="line">        enabled: true</span><br><span class="line">        root: /cloud-config</span><br><span class="line">        watcher:</span><br><span class="line">          enabled: true</span><br></pre></td></tr></table></figure><h4 id="3-æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…å¯åŠ¨ç±»"><a href="#3-æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…å¯åŠ¨ç±»" class="headerlink" title="3.æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…å¯åŠ¨ç±»"></a>3.æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…å¯åŠ¨ç±»</h4><p>å¯åŠ¨ç±»ä¸Šé¢éƒ½æ–°å¢@EnableDiscoveryClientæ³¨è§£</p><h4 id="4-å°†seataé…ç½®æ–‡ä»¶å¯¼å…¥zookeeperé…ç½®ä¸­å¿ƒ"><a href="#4-å°†seataé…ç½®æ–‡ä»¶å¯¼å…¥zookeeperé…ç½®ä¸­å¿ƒ" class="headerlink" title="4.å°†seataé…ç½®æ–‡ä»¶å¯¼å…¥zookeeperé…ç½®ä¸­å¿ƒ"></a>4.å°†seataé…ç½®æ–‡ä»¶å¯¼å…¥zookeeperé…ç½®ä¸­å¿ƒ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">/seata=client.log.exceptionRate=100</span><br><span class="line">/seata=client.report.retry.count=5</span><br><span class="line">/seata=client.rm.asyncCommitBufferLimit=10000</span><br><span class="line">/seata=client.rm.lockRetryInternal=10</span><br><span class="line">/seata=client.rm.lockRetryPolicyBranchRollbackOnConflict=true</span><br><span class="line">/seata=client.rm.lockRetryTimes=30</span><br><span class="line">/seata=client.rm.reportRetryCount=5</span><br><span class="line">/seata=client.rm.reportSuccessEnable=false</span><br><span class="line">/seata=client.rm.sqlParserType=druid</span><br><span class="line">/seata=client.rm.tableMetaCheckEnable=false</span><br><span class="line">/seata=client.tm.commitRetryCount=5</span><br><span class="line">/seata=client.tm.rollbackRetryCount=5</span><br><span class="line">/seata=client.undo.dataValidation=true</span><br><span class="line">/seata=client.undo.logSerialization=jackson</span><br><span class="line">/seata=client.undo.logTable=undo_log</span><br><span class="line">/seata=metrics.enabled=false</span><br><span class="line">/seata=metrics.exporterList=prometheus</span><br><span class="line">/seata=metrics.exporterPrometheusPort=9898</span><br><span class="line">/seata=metrics.registryType=compact</span><br><span class="line">/seata=server.maxCommitRetryTimeout=-1</span><br><span class="line">/seata=server.maxRollbackRetryTimeout=-1</span><br><span class="line">/seata=server.recovery.asynCommittingRetryPeriod=1000</span><br><span class="line">/seata=server.recovery.committingRetryPeriod=1000</span><br><span class="line">/seata=server.recovery.rollbackingRetryPeriod=1000</span><br><span class="line">/seata=server.recovery.timeoutRetryPeriod=1000</span><br><span class="line">/seata=server.rollbackRetryTimeoutUnlockEnable=false</span><br><span class="line">/seata=server.undo.logDeletePeriod=86400000</span><br><span class="line">/seata=server.undo.logSaveDays=7</span><br><span class="line">/seata=service.default.grouplist=127.0.0.1:8091</span><br><span class="line">/seata=service.disableGlobalTransaction=false</span><br><span class="line">/seata=service.enableDegrade=false</span><br><span class="line">/seata=service.vgroupMapping.provider-service-group=default</span><br><span class="line">/seata=service.vgroupMapping.consumer-service-group=default</span><br><span class="line">/seata=store.db.branchTable=branch_table</span><br><span class="line">/seata=store.db.datasource=dbcp</span><br><span class="line">/seata=store.db.dbType=mysql</span><br><span class="line">/seata=store.db.driverClassName=com.mysql.cj.jdbc.Driver</span><br><span class="line">/seata=store.db.globalTable=global_table</span><br><span class="line">/seata=store.db.lockTable=lock_table</span><br><span class="line">/seata=store.db.maxConn=3</span><br><span class="line">/seata=store.db.minConn=1</span><br><span class="line">/seata=store.db.password=123456</span><br><span class="line">/seata=store.db.queryLimit=100</span><br><span class="line">/seata=store.db.url=jdbc:mysql://127.0.0.1:3306/cloud?useUnicode=true</span><br><span class="line">/seata=store.db.user=root</span><br><span class="line">/seata=store.file.dir=file_store/data</span><br><span class="line">/seata=store.file.fileWriteBufferCacheSize=16384</span><br><span class="line">/seata=store.file.flushDiskMode=async</span><br><span class="line">/seata=store.file.maxBranchSessionSize=16384</span><br><span class="line">/seata=store.file.maxGlobalSessionSize=512</span><br><span class="line">/seata=store.file.sessionReloadReadSize=100</span><br><span class="line">/seata=store.mode=db</span><br><span class="line">/seata=transport.compressor=none</span><br><span class="line">/seata=transport.enableClientBatchSendRequest=false</span><br><span class="line">/seata=transport.heartbeat=true</span><br><span class="line">/seata=transport.serialization=seata</span><br><span class="line">/seata=transport.server=NIO</span><br><span class="line">/seata=transport.shutdown.wait=3</span><br><span class="line">/seata=transport.threadFactory.bossThreadPrefix=NettyBoss</span><br><span class="line">/seata=transport.threadFactory.bossThreadSize=1</span><br><span class="line">/seata=transport.threadFactory.clientSelectorThreadPrefix=NettyClientSelector</span><br><span class="line">/seata=transport.threadFactory.clientSelectorThreadSize=1</span><br><span class="line">/seata=transport.threadFactory.clientWorkerThreadPrefix=NettyClientWorkerThread</span><br><span class="line">/seata=transport.threadFactory.serverExecutorThreadPrefix=NettyServerBizHandler</span><br><span class="line">/seata=transport.threadFactory.shareBossWorker=false</span><br><span class="line">/seata=transport.threadFactory.workerThreadPrefix=NettyServerNIOWorker</span><br><span class="line">/seata=transport.threadFactory.workerThreadSize=default</span><br><span class="line">/seata=transport.type=TCP</span><br></pre></td></tr></table></figure><p>æ¯æ–°åŠ ä¸€ä¸ªæœåŠ¡å°±è¦å¯¼å…¥ä¸€ä¸ªæ–°çš„é…ç½®ï¼Œxxxå¯ä»¥è‡ªå®šä¹‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/seata=service.vgroupMapping.xxx=default</span><br></pre></td></tr></table></figure><h4 id="5-æ–°å¢seataçš„ymlé…ç½®åˆ°providerå’Œconsumer"><a href="#5-æ–°å¢seataçš„ymlé…ç½®åˆ°providerå’Œconsumer" class="headerlink" title="5.æ–°å¢seataçš„ymlé…ç½®åˆ°providerå’Œconsumer"></a>5.æ–°å¢seataçš„ymlé…ç½®åˆ°providerå’Œconsumer</h4><h5 id="provider-yml"><a href="#provider-yml" class="headerlink" title="provider yml"></a>provider yml</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">seata:</span><br><span class="line">  enabled: true</span><br><span class="line">  application-id: provider-seata</span><br><span class="line">  tx-service-group: provider-service-group # äº‹åŠ¡ç¾¤ç»„ï¼ˆå¯ä»¥æ¯ä¸ªåº”ç”¨ç‹¬ç«‹å–åï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸åŒçš„åå­—ï¼‰è¿™ä¸ªç¾¤ç»„åä¸€å®šè¦å’Œä¸Šé¢çš„seata=service.vgroupMappingä¸­çš„xxxç›¸ç­‰</span><br><span class="line">  client:</span><br><span class="line">    rm-report-success-enable: true</span><br><span class="line">    rm-table-meta-check-enable: false # è‡ªåŠ¨åˆ·æ–°ç¼“å­˜ä¸­çš„è¡¨ç»“æ„ï¼ˆé»˜è®¤falseï¼‰</span><br><span class="line">    rm-report-retry-count: 5 # ä¸€é˜¶æ®µç»“æœä¸ŠæŠ¥TCé‡è¯•æ¬¡æ•°ï¼ˆé»˜è®¤5ï¼‰</span><br><span class="line">    rm-async-commit-buffer-limit: 10000 # å¼‚æ­¥æäº¤ç¼“å­˜é˜Ÿåˆ—é•¿åº¦ï¼ˆé»˜è®¤10000ï¼‰</span><br><span class="line">    rm:</span><br><span class="line">      lock:</span><br><span class="line">        lock-retry-internal: 10 # æ ¡éªŒæˆ–å ç”¨å…¨å±€é”é‡è¯•é—´éš”ï¼ˆé»˜è®¤10msï¼‰</span><br><span class="line">        lock-retry-times: 30 # æ ¡éªŒæˆ–å ç”¨å…¨å±€é”é‡è¯•æ¬¡æ•°ï¼ˆé»˜è®¤30ï¼‰</span><br><span class="line">        lock-retry-policy-branch-rollback-on-conflict: true # åˆ†æ”¯äº‹åŠ¡ä¸å…¶å®ƒå…¨å±€å›æ»šäº‹åŠ¡å†²çªæ—¶é”ç­–ç•¥ï¼ˆä¼˜å…ˆé‡Šæ”¾æœ¬åœ°é”è®©å›æ»šæˆåŠŸï¼‰</span><br><span class="line">    tm-commit-retry-count: 3 # ä¸€é˜¶æ®µå…¨å±€æäº¤ç»“æœä¸ŠæŠ¥TCé‡è¯•æ¬¡æ•°ï¼ˆé»˜è®¤1æ¬¡ï¼Œå»ºè®®å¤§äº1ï¼‰</span><br><span class="line">    tm-rollback-retry-count: 3 # ä¸€é˜¶æ®µå…¨å±€å›æ»šç»“æœä¸ŠæŠ¥TCé‡è¯•æ¬¡æ•°ï¼ˆé»˜è®¤1æ¬¡ï¼Œå»ºè®®å¤§äº1ï¼‰</span><br><span class="line">    undo:</span><br><span class="line">      undo-data-validation: true # äºŒé˜¶æ®µå›æ»šé•œåƒæ ¡éªŒï¼ˆé»˜è®¤trueå¼€å¯ï¼‰</span><br><span class="line">      undo-log-serialization: jackson # undoåºåˆ—åŒ–æ–¹å¼ï¼ˆé»˜è®¤jacksonï¼‰</span><br><span class="line">      undo-log-table: undo_log  # è‡ªå®šä¹‰undoè¡¨åï¼ˆé»˜è®¤undo_logï¼‰</span><br><span class="line">    support:</span><br><span class="line">      spring:</span><br><span class="line">        datasource-autoproxy: true</span><br><span class="line">  service:</span><br><span class="line">    vgroup-mapping:</span><br><span class="line">      my_test_tx_group: default # TC é›†ç¾¤ï¼ˆå¿…é¡»ä¸seata-serverä¿æŒä¸€è‡´ï¼‰</span><br><span class="line">    enable-degrade: false # é™çº§å¼€å…³</span><br><span class="line">    disable-global-transaction: false # ç¦ç”¨å…¨å±€äº‹åŠ¡ï¼ˆé»˜è®¤falseï¼‰</span><br><span class="line">    grouplist:</span><br><span class="line">      default: 127.0.0.1:8091</span><br><span class="line">  transport:</span><br><span class="line">    shutdown:</span><br><span class="line">      wait: 3</span><br><span class="line">    thread-factory:</span><br><span class="line">      boss-thread-prefix: NettyBoss</span><br><span class="line">      worker-thread-prefix: NettyServerNIOWorker</span><br><span class="line">      server-executor-thread-prefix: NettyServerBizHandler</span><br><span class="line">      share-boss-worker: false</span><br><span class="line">      client-selector-thread-prefix: NettyClientSelector</span><br><span class="line">      client-selector-thread-size: 1</span><br><span class="line">      client-worker-thread-prefix: NettyClientWorkerThread</span><br><span class="line">    type: TCP</span><br><span class="line">    server: NIO</span><br><span class="line">    heartbeat: true</span><br><span class="line">    serialization: seata</span><br><span class="line">    compressor: none</span><br><span class="line">    enable-client-batch-send-request: true # å®¢æˆ·ç«¯äº‹åŠ¡æ¶ˆæ¯è¯·æ±‚æ˜¯å¦æ‰¹é‡åˆå¹¶å‘é€ï¼ˆé»˜è®¤trueï¼‰</span><br><span class="line">  registry:</span><br><span class="line">    file:</span><br><span class="line">      name: file.conf</span><br><span class="line">    type: zk</span><br><span class="line">    zk:</span><br><span class="line">      server-addr: 127.0.0.1:2181</span><br><span class="line">  config:</span><br><span class="line">    file:</span><br><span class="line">      name: file.conf</span><br><span class="line">    type: zk</span><br><span class="line">    zk:</span><br><span class="line">      server-addr: 127.0.0.1:2181</span><br></pre></td></tr></table></figure><h5 id="consumer-yml"><a href="#consumer-yml" class="headerlink" title="consumer yml"></a>consumer yml</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">seata:</span><br><span class="line">  enabled: true</span><br><span class="line">  application-id: consumer-seata</span><br><span class="line">  tx-service-group: consumer-service-group # äº‹åŠ¡ç¾¤ç»„ï¼ˆå¯ä»¥æ¯ä¸ªåº”ç”¨ç‹¬ç«‹å–åï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸åŒçš„åå­—ï¼‰è¿™ä¸ªç¾¤ç»„åä¸€å®šè¦å’Œä¸Šé¢çš„seata=service.vgroupMappingä¸­çš„xxxç›¸ç­‰</span><br><span class="line">  client:</span><br><span class="line">    rm-report-success-enable: true</span><br><span class="line">    rm-table-meta-check-enable: false # è‡ªåŠ¨åˆ·æ–°ç¼“å­˜ä¸­çš„è¡¨ç»“æ„ï¼ˆé»˜è®¤falseï¼‰</span><br><span class="line">    rm-report-retry-count: 5 # ä¸€é˜¶æ®µç»“æœä¸ŠæŠ¥TCé‡è¯•æ¬¡æ•°ï¼ˆé»˜è®¤5ï¼‰</span><br><span class="line">    rm-async-commit-buffer-limit: 10000 # å¼‚æ­¥æäº¤ç¼“å­˜é˜Ÿåˆ—é•¿åº¦ï¼ˆé»˜è®¤10000ï¼‰</span><br><span class="line">    rm:</span><br><span class="line">      lock:</span><br><span class="line">        lock-retry-internal: 10 # æ ¡éªŒæˆ–å ç”¨å…¨å±€é”é‡è¯•é—´éš”ï¼ˆé»˜è®¤10msï¼‰</span><br><span class="line">        lock-retry-times: 30 # æ ¡éªŒæˆ–å ç”¨å…¨å±€é”é‡è¯•æ¬¡æ•°ï¼ˆé»˜è®¤30ï¼‰</span><br><span class="line">        lock-retry-policy-branch-rollback-on-conflict: true # åˆ†æ”¯äº‹åŠ¡ä¸å…¶å®ƒå…¨å±€å›æ»šäº‹åŠ¡å†²çªæ—¶é”ç­–ç•¥ï¼ˆä¼˜å…ˆé‡Šæ”¾æœ¬åœ°é”è®©å›æ»šæˆåŠŸï¼‰</span><br><span class="line">    tm-commit-retry-count: 3 # ä¸€é˜¶æ®µå…¨å±€æäº¤ç»“æœä¸ŠæŠ¥TCé‡è¯•æ¬¡æ•°ï¼ˆé»˜è®¤1æ¬¡ï¼Œå»ºè®®å¤§äº1ï¼‰</span><br><span class="line">    tm-rollback-retry-count: 3 # ä¸€é˜¶æ®µå…¨å±€å›æ»šç»“æœä¸ŠæŠ¥TCé‡è¯•æ¬¡æ•°ï¼ˆé»˜è®¤1æ¬¡ï¼Œå»ºè®®å¤§äº1ï¼‰</span><br><span class="line">    undo:</span><br><span class="line">      undo-data-validation: true # äºŒé˜¶æ®µå›æ»šé•œåƒæ ¡éªŒï¼ˆé»˜è®¤trueå¼€å¯ï¼‰</span><br><span class="line">      undo-log-serialization: jackson # undoåºåˆ—åŒ–æ–¹å¼ï¼ˆé»˜è®¤jacksonï¼‰</span><br><span class="line">      undo-log-table: undo_log  # è‡ªå®šä¹‰undoè¡¨åï¼ˆé»˜è®¤undo_logï¼‰</span><br><span class="line">    support:</span><br><span class="line">      spring:</span><br><span class="line">        datasource-autoproxy: true</span><br><span class="line">  service:</span><br><span class="line">    vgroup-mapping:</span><br><span class="line">      my_test_tx_group: default # TC é›†ç¾¤ï¼ˆå¿…é¡»ä¸seata-serverä¿æŒä¸€è‡´ï¼‰</span><br><span class="line">    enable-degrade: false # é™çº§å¼€å…³</span><br><span class="line">    disable-global-transaction: false # ç¦ç”¨å…¨å±€äº‹åŠ¡ï¼ˆé»˜è®¤falseï¼‰</span><br><span class="line">    grouplist:</span><br><span class="line">      default: 127.0.0.1:8091</span><br><span class="line">  transport:</span><br><span class="line">    shutdown:</span><br><span class="line">      wait: 3</span><br><span class="line">    thread-factory:</span><br><span class="line">      boss-thread-prefix: NettyBoss</span><br><span class="line">      worker-thread-prefix: NettyServerNIOWorker</span><br><span class="line">      server-executor-thread-prefix: NettyServerBizHandler</span><br><span class="line">      share-boss-worker: false</span><br><span class="line">      client-selector-thread-prefix: NettyClientSelector</span><br><span class="line">      client-selector-thread-size: 1</span><br><span class="line">      client-worker-thread-prefix: NettyClientWorkerThread</span><br><span class="line">    type: TCP</span><br><span class="line">    server: NIO</span><br><span class="line">    heartbeat: true</span><br><span class="line">    serialization: seata</span><br><span class="line">    compressor: none</span><br><span class="line">    enable-client-batch-send-request: true # å®¢æˆ·ç«¯äº‹åŠ¡æ¶ˆæ¯è¯·æ±‚æ˜¯å¦æ‰¹é‡åˆå¹¶å‘é€ï¼ˆé»˜è®¤trueï¼‰</span><br><span class="line">  registry:</span><br><span class="line">    file:</span><br><span class="line">      name: file.conf</span><br><span class="line">    type: zk</span><br><span class="line">    zk:</span><br><span class="line">      server-addr: 127.0.0.1:2181</span><br><span class="line">  config:</span><br><span class="line">    file:</span><br><span class="line">      name: file.conf</span><br><span class="line">    type: zk</span><br><span class="line">    zk:</span><br><span class="line">      server-addr: 127.0.0.1:2181</span><br></pre></td></tr></table></figure><h4 id="6-ä¸‹è½½seataå¹¶ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#6-ä¸‹è½½seataå¹¶ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="6.ä¸‹è½½seataå¹¶ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>6.ä¸‹è½½seataå¹¶ä¿®æ”¹é…ç½®æ–‡ä»¶</h4><h5 id="ä¿®æ”¹file-conf"><a href="#ä¿®æ”¹file-conf" class="headerlink" title="ä¿®æ”¹file.conf"></a>ä¿®æ”¹file.conf</h5><p><img src="https://s4.ax1x.com/2022/01/07/7peqN4.png" alt="æŒ‰ç…§å›¾ä¸­æ ‡è¯†ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°"></p><h5 id="ä¿®æ”¹registry-conf"><a href="#ä¿®æ”¹registry-conf" class="headerlink" title="ä¿®æ”¹registry.conf"></a>ä¿®æ”¹registry.conf</h5><p><img src="https://s4.ax1x.com/2022/01/07/7pebEF.png" alt="æŒ‰ç…§å›¾ä¸­æ ‡è¯†ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°"></p><h4 id="7-å„ä¸ªå­æœåŠ¡çš„æ•°æ®åº“å¯¼å…¥seataçš„sql"><a href="#7-å„ä¸ªå­æœåŠ¡çš„æ•°æ®åº“å¯¼å…¥seataçš„sql" class="headerlink" title="7.å„ä¸ªå­æœåŠ¡çš„æ•°æ®åº“å¯¼å…¥seataçš„sql"></a>7.å„ä¸ªå­æœåŠ¡çš„æ•°æ®åº“å¯¼å…¥seataçš„sql</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> Navicat Premium Data Transfer</span><br><span class="line"></span><br><span class="line"> Source Server Type    : MySQL</span><br><span class="line"> Source Server Version : 80025</span><br><span class="line"></span><br><span class="line"> Target Server Type    : MySQL</span><br><span class="line"> Target Server Version : 80025</span><br><span class="line"> File Encoding         : 65001</span><br><span class="line"></span><br><span class="line"> Date: 02/01/2022 10:57:18</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">SET NAMES utf8mb4;</span><br><span class="line">SET FOREIGN_KEY_CHECKS = 0;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure for branch_table</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `branch_table`;</span><br><span class="line">CREATE TABLE `branch_table`  (</span><br><span class="line">  `branch_id` bigint NOT NULL,</span><br><span class="line">  `xid` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,</span><br><span class="line">  `transaction_id` bigint NULL DEFAULT NULL,</span><br><span class="line">  `resource_group_id` varchar(32) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,</span><br><span class="line">  `resource_id` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,</span><br><span class="line">  `lock_key` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,</span><br><span class="line">  `branch_type` varchar(8) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,</span><br><span class="line">  `status` tinyint NULL DEFAULT NULL,</span><br><span class="line">  `client_id` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,</span><br><span class="line">  `application_data` varchar(2000) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,</span><br><span class="line">  `gmt_create` datetime NULL DEFAULT NULL,</span><br><span class="line">  `gmt_modified` datetime NULL DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`branch_id`) USING BTREE,</span><br><span class="line">  INDEX `idx_xid`(`xid`) USING BTREE</span><br><span class="line">) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci ROW_FORMAT = Dynamic;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure for global_table</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `global_table`;</span><br><span class="line">CREATE TABLE `global_table`  (</span><br><span class="line">  `xid` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,</span><br><span class="line">  `transaction_id` bigint NULL DEFAULT NULL,</span><br><span class="line">  `status` tinyint NOT NULL,</span><br><span class="line">  `application_id` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,</span><br><span class="line">  `transaction_service_group` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,</span><br><span class="line">  `transaction_name` varchar(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,</span><br><span class="line">  `timeout` int NULL DEFAULT NULL,</span><br><span class="line">  `begin_time` bigint NULL DEFAULT NULL,</span><br><span class="line">  `application_data` varchar(2000) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,</span><br><span class="line">  `gmt_create` datetime NULL DEFAULT NULL,</span><br><span class="line">  `gmt_modified` datetime NULL DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`xid`) USING BTREE,</span><br><span class="line">  INDEX `idx_gmt_modified_status`(`gmt_modified`, `status`) USING BTREE,</span><br><span class="line">  INDEX `idx_transaction_id`(`transaction_id`) USING BTREE</span><br><span class="line">) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci ROW_FORMAT = Dynamic;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure for lock_table</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `lock_table`;</span><br><span class="line">CREATE TABLE `lock_table`  (</span><br><span class="line">  `row_key` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,</span><br><span class="line">  `xid` varchar(96) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,</span><br><span class="line">  `transaction_id` mediumtext CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL,</span><br><span class="line">  `branch_id` mediumtext CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL,</span><br><span class="line">  `resource_id` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,</span><br><span class="line">  `table_name` varchar(32) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,</span><br><span class="line">  `pk` varchar(32) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,</span><br><span class="line">  `gmt_create` datetime NULL DEFAULT NULL,</span><br><span class="line">  `gmt_modified` datetime NULL DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`row_key`) USING BTREE</span><br><span class="line">) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci ROW_FORMAT = Dynamic;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure for undo_log</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `undo_log`;</span><br><span class="line">CREATE TABLE `undo_log`  (</span><br><span class="line">  `id` bigint NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `branch_id` bigint NOT NULL,</span><br><span class="line">  `xid` varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,</span><br><span class="line">  `context` varchar(128) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,</span><br><span class="line">  `rollback_info` longblob NOT NULL,</span><br><span class="line">  `log_status` int NOT NULL,</span><br><span class="line">  `log_created` datetime NOT NULL,</span><br><span class="line">  `log_modified` datetime NOT NULL,</span><br><span class="line">  `ext` varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`id`) USING BTREE,</span><br><span class="line">  UNIQUE INDEX `ux_undo_log`(`xid`, `branch_id`) USING BTREE</span><br><span class="line">) ENGINE = InnoDB AUTO_INCREMENT = 30 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;</span><br><span class="line"></span><br><span class="line">SET FOREIGN_KEY_CHECKS = 1;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œseata-server.shï¼Œåœ¨éœ€è¦ä¿æŒäº‹åŠ¡çš„ServiceåŠ ä¸Š@GlobalTransactionalå³å¯</p>]]></content>
      
      
      
        <tags>
            
            <tag> å¾®æœåŠ¡ </tag>
            
            <tag> zookeeper </tag>
            
            <tag> åˆ†å¸ƒå¼äº‹åŠ¡ </tag>
            
            <tag> seata </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–å†™Linuxä¸­frpè‡ªå¯åŠ¨è„šæœ¬</title>
      <link href="/2021/12/01/1/"/>
      <url>/2021/12/01/1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å®¶é‡Œæœ‰å°é—²ç½®æ ‘è“æ´¾å’Œè½»é‡äº‘çš„æœåŠ¡å™¨é¡ºæ‰‹æŠ˜è…¾ä¸€ä¸‹</p></blockquote><p>è®¾ç½®æœåŠ¡å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /lib/systemd/system/frps.service</span><br></pre></td></tr></table></figure><p>å†™å…¥ä¸‹åˆ—ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=frps service</span><br><span class="line">#å‰ç½®æœåŠ¡</span><br><span class="line">After=network.target syslog.target</span><br><span class="line">#åç½®æœåŠ¡</span><br><span class="line">Wants=network.target</span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">Restart=always #å½“ç¨‹åºé€€å‡ºæ—¶ï¼Œè‡ªåŠ¨é‡å¯ã€‚</span><br><span class="line">#å¯ä»¥ä½¿ç”¨érootç”¨æˆ·å¯åŠ¨ï¼Œæ­¤å¤„æˆ‘æ²¡æœ‰è®¾ç½®ç”¨æˆ·ç»„åˆ™æ³¨é‡Šè°ƒ</span><br><span class="line">#User=frp</span><br><span class="line">#Group=frp</span><br><span class="line">#å¯åŠ¨æœåŠ¡çš„å‘½ä»¤ï¼ˆæ­¤å¤„å†™ä½ çš„frpsçš„å®é™…å®‰è£…ç›®å½•ï¼‰</span><br><span class="line">ExecStart=~/frp/frps -c ~/frp/frps.ini</span><br><span class="line">ExecStop=/bin/kill $MAINPID</span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><p>åˆ·æ–°æœåŠ¡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br></pre></td></tr></table></figure><p>æœåŠ¡è‡ªå¯åŠ¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable frps</span><br></pre></td></tr></table></figure><p>é‡å¯æœåŠ¡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart frps</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„è½¯è¿æ¥æ‰€åœ¨ä½ç½®ï¼Œä¸€èˆ¬åœ¨éœ€è¦åˆ é™¤è¯¥è‡ªå¯åŠ¨è„šæœ¬æ—¶åŒæ—¶åˆ é™¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/etc/systemd/system/multi-user.target.wants/frps.service</span><br><span class="line"></span><br><span class="line">/usr/lib/systemd/system/frps.service</span><br></pre></td></tr></table></figure><p>frpéƒ¨ç½²æ–‡æ¡£å‚è€ƒ ğŸ‘‰ <a href="https://gofrp.org/docs/setup/">ã€Šå®‰è£…frpã€‹</a>- frpå®˜æ–¹æ–‡æ¡£</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> è¿ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸ªäººæŠ€èƒ½ç½‘-å¾…è¡¥å……æŒæ¡ç¨‹åº¦</title>
      <link href="/2021/10/01/1/"/>
      <url>/2021/10/01/1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>çŸ¥è¯†å’ŒçŸ¥è¯†ä¹‹é—´æ˜¯æœ‰è”ç³»çš„ã€‚</p></blockquote><h4 id="ç²¾é€šï¼ˆå¾…å®Œå–„ï¼‰"><a href="#ç²¾é€šï¼ˆå¾…å®Œå–„ï¼‰" class="headerlink" title="ç²¾é€šï¼ˆå¾…å®Œå–„ï¼‰"></a>ç²¾é€šï¼ˆå¾…å®Œå–„ï¼‰</h4><h4 id="ç†Ÿç»ƒï¼ˆå¾…å®Œå–„ï¼‰"><a href="#ç†Ÿç»ƒï¼ˆå¾…å®Œå–„ï¼‰" class="headerlink" title="ç†Ÿç»ƒï¼ˆå¾…å®Œå–„ï¼‰"></a>ç†Ÿç»ƒï¼ˆå¾…å®Œå–„ï¼‰</h4><h4 id="ç”Ÿç–ï¼ˆå¾…å®Œå–„ï¼‰"><a href="#ç”Ÿç–ï¼ˆå¾…å®Œå–„ï¼‰" class="headerlink" title="ç”Ÿç–ï¼ˆå¾…å®Œå–„ï¼‰"></a>ç”Ÿç–ï¼ˆå¾…å®Œå–„ï¼‰</h4><h4 id="äº†è§£ï¼ˆå¾…å®Œå–„ï¼‰"><a href="#äº†è§£ï¼ˆå¾…å®Œå–„ï¼‰" class="headerlink" title="äº†è§£ï¼ˆå¾…å®Œå–„ï¼‰"></a>äº†è§£ï¼ˆå¾…å®Œå–„ï¼‰</h4><h4 id="è€³é—»ï¼ˆå¾…å®Œå–„ï¼‰"><a href="#è€³é—»ï¼ˆå¾…å®Œå–„ï¼‰" class="headerlink" title="è€³é—»ï¼ˆå¾…å®Œå–„ï¼‰"></a>è€³é—»ï¼ˆå¾…å®Œå–„ï¼‰</h4><p><img src="https://z3.ax1x.com/2021/11/09/It1R3Q.png" alt="ä¸ªäººæŠ€èƒ½ç½‘"></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ€»ç»“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æœåŠ¡é“¾è·¯è¿½è¸ªSkyWalking</title>
      <link href="/2021/05/02/1/"/>
      <url>/2021/05/02/1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>SkyWalkingè¶…çº§ç®€å•çš„å¾®æœåŠ¡é“¾è·¯è¿½è¸ªæ¡†æ¶</p></blockquote><h4 id="1-ä¸‹è½½å®‰è£…åŒ…"><a href="#1-ä¸‹è½½å®‰è£…åŒ…" class="headerlink" title="1.ä¸‹è½½å®‰è£…åŒ…"></a>1.ä¸‹è½½å®‰è£…åŒ…</h4><p>SkyWalking<a href="https://skywalking.apache.org/downloads/">ä¸‹è½½åœ°å€</a>ï¼Œçœ‹äº†å¥½å¤šåšå®¢æ²¡ä¸€ä¸ªæè¿°æ¸…æ¥šè¦ä¸‹è½½å“ªä¸ªæ–‡ä»¶çš„ï¼Œæˆ‘è‡ªå·±ä¹Ÿæäº†åŠå¤©ï¼Œå°±æ˜¯ä¸‹å›¾å®ƒå…„å¼Ÿä¿©éƒ½è¦ä¸‹è½½ï¼Œç¬¬ä¸€ä¸ªæ˜¯SkyWalkingçš„æœåŠ¡ï¼Œç¬¬äºŒä¸ªæ˜¯Javaçš„æ‰©å±•ã€‚</p><p><a href="https://imgtu.com/i/7eB7vV"><img src="https://s4.ax1x.com/2022/01/11/7eB7vV.md.png" alt="7eB7vV.md.png"></a></p><h4 id="2-ä¿®æ”¹å¯åŠ¨å‚æ•°"><a href="#2-ä¿®æ”¹å¯åŠ¨å‚æ•°" class="headerlink" title="2.ä¿®æ”¹å¯åŠ¨å‚æ•°"></a>2.ä¿®æ”¹å¯åŠ¨å‚æ•°</h4><p>é¦–å…ˆè§£å‹<strong>SkyWalking Java Agent</strong>æ–‡ä»¶ï¼Œæ‰¾åˆ°<strong>skywalking-agent.jar</strong>ï¼Œè®°ä¸‹æ‰€åœ¨ä½ç½®ã€‚ç„¶åä¿®æ”¹ideaä¸­é¡¹ç›®çš„å¯åŠ¨é…ç½®ï¼Œç‚¹å‡»ideaä¸­çš„Edit Configurationsâ€¦ã€‚ç‚¹å‡»éœ€è¦åŠ å…¥é“¾è·¯è¿½è¸ªçš„æœåŠ¡ï¼Œå°†ä¸‹åˆ—å‚æ•°å¦‚å›¾æ‰€ç¤ºåˆ†åˆ«åŠ å…¥VM optionså’ŒEnvironment variablesä¸­ã€‚éœ€è¦é“¾è·¯è¿½è¸ªèƒ½æŸ¥çœ‹å…¶ä»–æœåŠ¡åˆ™æŒ‰ç…§ä¸Šé¢æ‰€è¿°ä¾æ¬¡æ·»åŠ å¯åŠ¨å‚æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-javaagent:D:\\tools\\skywalking-agent\\skywalking-agent.jar</span><br><span class="line">SW_AGENT_NAME=cloud-auth;SW_AGENT_COLLECTOR_BACKEND_SERVICES=127.0.0.1:11800</span><br></pre></td></tr></table></figure><p><a href="https://imgtu.com/i/7ecFNF"><img src="https://s4.ax1x.com/2022/01/11/7ecFNF.md.png" alt="7ecFNF.md.png"></a></p><p>ç„¶åè§£å‹æ‰“å¼€<strong>SkyWalking APM</strong>çš„ä¸‹è½½åŒ…ï¼Œè§£å‹åè¿›å…¥æ–‡ä»¶å¤¹ä¸‹çš„binç›®å½•ï¼Œwindowså°±æ‰§è¡Œstartup.batï¼Œlinuxå°±æ‰§è¡Œstartup.shã€‚</p><p>æœ€åå¯åŠ¨å„ä¸ªå¾®æœåŠ¡ï¼Œåœ¨é¡¹ç›®å¯åŠ¨æ—¶å½“æ‰“å°å‡ºæ¥ä»¥ä¸‹ç±»ä¼¼çš„æ—¥å¿—æ—¶ï¼Œåˆ™ä»£è¡¨SkyWalkingå¯åŠ¨æˆåŠŸã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">main AgentPackagePath : The beacon class location is jar:file:/D:/tools/skywalking-agent/skywalking-agent.jar!/org/apache/skywalking/apm/agent/core/boot/AgentPackagePath.class.</span><br><span class="line">main SnifferConfigInitializer : Config file found in D:\tools\skywalking-agent\config\agent.config.</span><br></pre></td></tr></table></figure><h4 id="3-æŸ¥çœ‹å¯åŠ¨æ•ˆæœ"><a href="#3-æŸ¥çœ‹å¯åŠ¨æ•ˆæœ" class="headerlink" title="3.æŸ¥çœ‹å¯åŠ¨æ•ˆæœ"></a>3.æŸ¥çœ‹å¯åŠ¨æ•ˆæœ</h4><p>SkyWalkingä¸­å‘ç°æœåŠ¡é€Ÿåº¦æœ‰äº›æ…¢ï¼Œç¨ç­‰ç‰‡åˆ»åè®¿é—®<strong>SkyWalking APM</strong>æ‰€åœ¨ç½‘ç»œä¸‹çš„localhost:8080å³å¯ï¼Œé¡µé¢æ•ˆæœå¦‚ä¸‹å›¾ã€‚</p><p><a href="https://imgtu.com/i/7eRjaV"><img src="https://s4.ax1x.com/2022/01/11/7eRjaV.md.png" alt="7eRjaV.md.png"></a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å¾®æœåŠ¡ </tag>
            
            <tag> ç›‘æ§ </tag>
            
            <tag> SkyWalking </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nettyåº”ç”¨ä»¥åŠæºç ï¼ˆä¸€ï¼‰</title>
      <link href="/2021/01/02/1/"/>
      <url>/2021/01/02/1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Nettyæ˜¯åŸºäºäº‹ä»¶å¤„ç†çš„é«˜æ€§èƒ½å¼‚æ­¥éé˜»å¡ç½‘ç»œæ¡†æ¶ï¼ŒZookeeperã€Dubboã€RocketMQåº•å±‚éƒ½æœ‰Nettyçš„å½±å­ï¼Œæ˜¯ç½‘ç»œç¼–ç¨‹çš„åŸºçŸ³ï¼Œéœ€è¦ç†Ÿç»ƒæŒæ¡</p></blockquote><h2 id="NIO"><a href="#NIO" class="headerlink" title="NIO"></a>NIO</h2><h4 id="è¿è¡ŒçŠ¶æ€å’Œå¼‚æ­¥åŒæ­¥"><a href="#è¿è¡ŒçŠ¶æ€å’Œå¼‚æ­¥åŒæ­¥" class="headerlink" title="è¿è¡ŒçŠ¶æ€å’Œå¼‚æ­¥åŒæ­¥"></a>è¿è¡ŒçŠ¶æ€å’Œå¼‚æ­¥åŒæ­¥</h4><p>æ³¡èŒ¶ä¾‹å­ï¼š</p><ul><li>åŒæ­¥ï¼šè‡ªå·±æ¥çƒ§æ°´ï¼Œè‡ªå·±æ¥æ³¡èŒ¶ï¼›</li><li>å¼‚æ­¥ï¼šè‡ªå·±çƒ§æ°´ï¼Œç„¶åèµ°äº†æ¢å¦ä¸€ä¸ªäººæ¥æ³¡èŒ¶ï¼›</li><li>é˜»å¡ï¼šè‡ªå·±æ¥çƒ§æ°´ï¼Œè‡ªå·±éœ€è¦ç«™åœ¨åŸåœ°ç­‰æ°´çƒ§å¼€ï¼›</li><li>éé˜»å¡ï¼šè‡ªå·±æ¥çƒ§æ°´ï¼Œè‡ªå·±å¯ä»¥åœ¨çƒ§æ°´é€”ä¸­åšå…¶ä»–çš„äº‹æƒ…ï¼›</li></ul><h4 id="ç½‘ç»œIO"><a href="#ç½‘ç»œIO" class="headerlink" title="ç½‘ç»œIO"></a>ç½‘ç»œIO</h4><ul><li>BIOï¼šblocking I/Oï¼Œé˜»å¡æ€§IOï¼Œéœ€è¦å½“å®¢æˆ·ç«¯å‘é€è¯·æ±‚ä¹‹å‰åˆ™å»ºç«‹ä¸€ä¸ªé˜»å¡çº¿ç¨‹ï¼Œå»ç›‘å¬ç«¯å£ï¼Œå¾…è¯·æ±‚å»ºç«‹è¿æ¥åç»§ç»­é˜»å¡ï¼Œå¾…å®¢æˆ·ç«¯å‘é€æ•°æ®åå†å¤„ç†æ•°æ®ï¼Œé€‚ç”¨äºè¿æ¥æ•°å›ºå®šä¸”è¾ƒå°çš„é¡¹ç›®ä¸­ï¼›</li><li>NIOï¼šnew I/Oï¼Œä½¿ç”¨å•ç‹¬çš„çº¿ç¨‹è¿›è¡Œè½®è¯¢æ˜¯å¦æœ‰äººå»ºç«‹è¿æ¥ï¼Œå½“å»ºç«‹äº†è¿æ¥åæ‰ä¼šä¸¢ç»™å·¥ä½œçº¿ç¨‹ç»„ï¼Œè®©çº¿ç¨‹ç»„ä»¥å—çš„æ¨¡å¼æ¥å¤„ç†å®¢æˆ·ç«¯æ•°æ®ï¼Œé€‚ç”¨äºè¿æ¥æ•°è¾ƒå¤§ä¸”è¿æ¥æ—¶é•¿è¾ƒçŸ­çš„ä¸šåŠ¡ï¼›</li><li>AIOï¼šasynchronous I/Oï¼Œå®Œå…¨å¼‚æ­¥çš„å¤„ç†å†…æ ¸æ€çš„å®¢æˆ·ç«¯æ•°æ®ï¼Œæ— éœ€å…³å¿ƒå»ºç«‹è¿æ¥çš„ç»†èŠ‚ï¼Œåªéœ€è¦æ ¹æ®ç³»ç»Ÿé€šçŸ¥è¿›è¡Œäº‹ä»¶å¤„ç†å³å¯ï¼Œé€‚ç”¨äºè¿æ¥æ•°è¾ƒå¤§ä¸”è¿æ¥æ—¶é•¿è¾ƒé•¿çš„ä¸šåŠ¡ï¼Œç”¨äºç³»ç»Ÿè°ƒç”¨æ¯”è¾ƒå¤šçš„åœºæ™¯ï¼Œä¾‹å¦‚æ–‡ä»¶ä¸‹è½½ï¼›</li></ul><h4 id="Reactoræ¨¡å¼"><a href="#Reactoræ¨¡å¼" class="headerlink" title="Reactoræ¨¡å¼"></a>Reactoræ¨¡å¼</h4><p>ä¸»è¦åˆ†ä¸ºreactorå’Œhandlerï¼Œreactorç”¨æ¥å¤„ç†å®¢æˆ·ç«¯è¿æ¥ï¼Œhandlerç”¨æ¥è´Ÿè´£å¤„ç†ç›¸å…³è¯·æ±‚ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> åç«¯ </tag>
            
            <tag> Netty </tag>
            
            <tag> æºç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLæ•°æ®åº“åŸç†å‰–æå’Œä¼˜åŒ–</title>
      <link href="/2020/05/02/1/"/>
      <url>/2020/05/02/1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ•°æ®åº“æ˜¯Webå¼€å‘ä¸­å¿…ä¸å¯å°‘çš„ä¸€ç¯ï¼Œéœ€è¦åŠ å¼ºåŸºç¡€çŸ¥è¯†çš„å­¦ä¹ å’Œæ€»ç»“é¡¹ç›®ä¸­å‡ºç°çš„é—®é¢˜ã€‚éš¾ç‚¹ä¸»è¦åœ¨ç´¢å¼•å’Œåˆ†å¸ƒå¼äº‹åŠ¡ä¸Šï¼Œç”±äºæœ¬äººé¡¹ç›®è¿‡ç¨‹ä¸­ä½¿ç”¨çš„æ•°æ®åº“å¤šä¸ºMySQLå’ŒMariaDBï¼Œæ‰€ä»¥ä»¥ä¸‹å†…å®¹æ‰€ä½¿ç”¨çš„æ•°æ®åº“ç¯å¢ƒå‡ä¸ºMySQL</p></blockquote><h2 id="æ•°æ®åº“åº•å±‚åŸç†"><a href="#æ•°æ®åº“åº•å±‚åŸç†" class="headerlink" title="æ•°æ®åº“åº•å±‚åŸç†"></a>æ•°æ®åº“åº•å±‚åŸç†</h2><h4 id="æ•°æ®å­˜å‚¨æ–¹å¼"><a href="#æ•°æ®å­˜å‚¨æ–¹å¼" class="headerlink" title="æ•°æ®å­˜å‚¨æ–¹å¼"></a>æ•°æ®å­˜å‚¨æ–¹å¼</h4><p>æ•°æ®åº“ä¸­InnoDBå’ŒMyISAMå­˜å‚¨å¼•æ“åº•å±‚é‡‡ç”¨çš„å­˜å‚¨æ–¹å¼ä¸ºB+æ ‘ï¼Œä¸‹é¢åˆ—ä¸¾ä¸€ä¸‹å„ä¸ªæ•°æ®ç»“æ„åœ¨æ•°æ®å­˜å‚¨æ—¶çš„æ¼”å˜è¿‡ç¨‹ã€‚</p><ul><li>æ•°ç»„ï¼šæŸ¥è¯¢å¿«ï¼Œæ’å…¥é€Ÿåº¦æ…¢ï¼›</li><li>é“¾è¡¨ï¼šæŸ¥è¯¢æ…¢ï¼Œæ’å…¥é€Ÿåº¦å¿«ï¼›</li><li>äºŒå‰æ ‘ï¼šæŸ¥è¯¢é€Ÿåº¦å¿«ï¼Œæ’å…¥é€Ÿåº¦å¿«ï¼Œä½†æ˜¯æç«¯æƒ…å†µä¼šå˜æˆé“¾è¡¨ï¼Œä¼šå¤§å¹…é™ä½æŸ¥è¯¢æ•ˆç‡ï¼Œä¾‹å¦‚æ ‘çš„èŠ‚ç‚¹ä¸º1ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰ã€2ã€3ã€4ã€5ã€6æ—¶ä¸”ä¸€ä¸ªèŠ‚ç‚¹åªæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹å­˜å‚¨æ•ˆç‡å¤ªå·®ï¼›</li><li>HASHè¡¨ï¼šå°†æ•°æ®è¿›è¡ŒHASHè¿ç®—ï¼Œå°†è¿ç®—å®Œæˆåçš„ç»“æœå­˜å…¥åœ°å€ï¼Œå½“å­˜åœ¨ç¢°æ’æ—¶ï¼Œå°†åœ°å€ä¸­çš„æ•°æ®ä»¥é“¾è¡¨çš„å½¢å¼å­˜å‚¨ï¼Œç¼ºç‚¹å› ä¸ºæ•°æ®æ˜¯è®¡ç®—åå­˜å‚¨çš„ï¼Œæ‰€ä»¥åœ¨èŒƒå›´æŸ¥è¯¢æ—¶ä¼šæ•ˆç‡ä½ä¸‹ï¼Œä¸€èˆ¬ç”¨äºMemoryå¼•æ“ï¼ˆä¸€ç§å®Œå…¨å­˜å‚¨åœ¨å†…å­˜ä¸­çš„å­˜å‚¨å¼•æ“ï¼‰ï¼›</li><li>çº¢é»‘æ ‘ï¼šæŸ¥è¯¢é€Ÿåº¦å¿«ï¼Œæ’å…¥é€Ÿåº¦æ…¢ï¼Œä½¿ç”¨æ ‘æ—‹è½¬ä¼˜åŒ–äº†äºŒå‰æ ‘çš„æç«¯æƒ…å†µï¼Œä¹Ÿå°±æ˜¯å½“å­˜åœ¨1ã€2ã€3ã€4ã€5ã€6æ—¶ï¼Œä¼šå°†æ ¹èŠ‚ç‚¹ä¼˜åŒ–ä¸º3ï¼Œç„¶åå±‚çº§é™ä½ä¸ºä¸‰å±‚ï¼Œä½†æ˜¯é¢‘ç¹æ—‹è½¬çš„æ—¶å€™ä¼šå¯¼è‡´æ’å…¥é€Ÿåº¦è¾ƒæ…¢ï¼›</li><li>Bæ ‘ï¼šæŸ¥è¯¢é€Ÿåº¦å¿«ï¼Œæ’å…¥é€Ÿåº¦å¿«ï¼Œä½¿ç”¨Bæ ‘å°†å­èŠ‚ç‚¹ä¸­çš„å†…å®¹è¿›è¡ŒèŒƒå›´åˆ’åˆ†ï¼Œä¸”å›ºå®šå±‚çº§ä¸ºä¸‰çº§ã€‚ä½†æ˜¯å…¶ä¸­çš„æ•°æ®éƒ½å­˜åœ¨èŠ‚ç‚¹å†…ï¼Œæ‰€ä»¥èŠ‚ç‚¹æ•°æ®å­˜å‚¨é‡å¤ªå°ï¼Œå†…å­˜åŠ è½½æ•°æ®é¡µæ—¶å¯å®¹çº³çš„æ•°æ®ä¹Ÿè¾ƒå°‘ï¼›</li><li>B+æ ‘ï¼šæŸ¥è¯¢é€Ÿåº¦å¿«ï¼Œæ’å…¥é€Ÿåº¦å¿«ï¼Œåœ¨å…·å¤‡Bæ ‘æ‰€æœ‰ä¼˜ç‚¹åŒæ—¶è¿˜å°†æ•°æ®å­˜å…¥å­èŠ‚ç‚¹ï¼Œç›¸é‚»çš„å¶å­èŠ‚ç‚¹ä¹‹é—´å¤´å°¾ç›¸è¿ï¼Œåœ¨æ•°æ®è¢«ä½¿ç”¨æ—¶é‚£ä¹ˆå®ƒé™„è¿‘çš„æ•°æ®ä¹Ÿä¼šè¢«ä½¿ç”¨ï¼Œå¯ä»¥é¢„åŠ è½½åˆ°å†…å­˜ä¸­ï¼›</li></ul><p>åœ¨ä¸åŒçš„å­˜å‚¨å¼•æ“ä¸­B+æ ‘çš„å­˜å‚¨æ–¹å¼ä¹Ÿæœ‰æ‰€ä¸åŒï¼ŒInnoDBæ˜¯é‡‡ç”¨èšé›†ç´¢å¼•ï¼ŒMyISAMæ˜¯é‡‡ç”¨éèšé›†ç´¢å¼•ã€‚InnoDBæœ‰ä¸”å¿…é¡»è¦æœ‰ä¸€ä¸ªèšé›†ç´¢å¼•ï¼Œä¸€èˆ¬æ˜¯ä¸»é”®ï¼Œæ²¡æœ‰ä¸»é”®åˆ™æ˜¯ç¬¬ä¸€ä¸ªéç©ºå­—æ®µã€‚</p><h4 id="ä¸»è¦æ„æˆ"><a href="#ä¸»è¦æ„æˆ" class="headerlink" title="ä¸»è¦æ„æˆ"></a>ä¸»è¦æ„æˆ</h4><p>ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åº“æœåŠ¡å…·å¤‡æ¨¡å—å¦‚ä¸‹ï¼š</p><ul><li>å®¢æˆ·ç«¯<ul><li>æ•°æ®åº“é©±åŠ¨</li><li>è¿æ¥æ± </li></ul></li><li>æœåŠ¡ç«¯<ul><li> è¿æ¥å™¨</li><li> åˆ†æå™¨</li><li> ä¼˜åŒ–å™¨</li><li> æ‰§è¡Œå™¨</li><li> å­˜å‚¨å¼•æ“</li></ul></li></ul><blockquote><p>è¯¦ç»†æµç¨‹ï¼šæ•°æ®åº“é©±åŠ¨é€šè¿‡è¿æ¥æ± å’ŒæœåŠ¡å™¨çš„è¿æ¥å™¨ç›¸è¿ï¼Œå½“å®¢æˆ·ç«¯æ¥å—åˆ°æ•°æ®æ—¶ï¼Œä¼šå°†æ•°æ®å‘é€è‡³æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯é€šè¿‡è¿æ¥å™¨æ¥å—å®¢æˆ·ç«¯çš„æ•°æ®ï¼Œéœ€è¦æŸ¥è¯¢çš„æ•°æ®æ˜¯å¦åœ¨å†…å­˜ä¸­ï¼Œåœ¨å†…å­˜ä¸­åˆ™è¿”å›ï¼Œä¸åœ¨å†…å­˜ä¸­åˆ™é€šè¿‡åˆ†æå™¨åˆ†æï¼Œåˆ†æåäº¤ç»™ä¼˜åŒ–å™¨ä¼˜åŒ–è¯­å¥ä¸ºAST treeï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰åå†äº¤ç»™æ‰§è¡Œå™¨æ‰§è¡Œè¯­å¥ï¼Œä»å­˜å‚¨å¼•æ“ä¸­æ‹‰å–æ•°æ®ã€‚</p></blockquote><p><img src="https://z3.ax1x.com/2021/11/09/It3a5T.png" alt="æ•°æ®åº“æŸ¥è¯¢æ‰§è¡Œæµç¨‹"></p><h4 id="æ•°æ®åº“æ€§èƒ½æµ‹è¯•"><a href="#æ•°æ®åº“æ€§èƒ½æµ‹è¯•" class="headerlink" title="æ•°æ®åº“æ€§èƒ½æµ‹è¯•"></a>æ•°æ®åº“æ€§èƒ½æµ‹è¯•</h4><p>åœ¨æ‹¿åˆ°æ•°æ®åº“æœåŠ¡åï¼Œé¦–å…ˆéœ€è¦é’ˆå¯¹æ•°æ®åº“è¿›è¡Œå‹æµ‹ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„å‹æµ‹å·¥å…·æœ‰sysbenchï¼Œå®ƒç›®å‰æ”¯æŒä¸»æµçš„Oracleã€MySQLå’ŒPostgreSQLç­‰æ•°æ®åº“ã€‚</p><p>æ•°æ®åº“æ€§èƒ½æµ‹è¯•æŒ‡æ ‡ä¸»è¦æœ‰CPUã€å†…å­˜ã€ç£ç›˜è¯»å†™ç‡ã€ç½‘ç»œååç‡å‡ ä¸ªæŒ‡æ ‡ï¼Œéœ€è¦å¯¹æ•°æ®åº“è¯»å†™è¯·æ±‚æˆåŠŸæ•°å’Œäº‹åŠ¡å®Œæˆæ•°æœ‰ä¸€ä¸ªå¤§æ¦‚çš„ä¼°ç®—ï¼Œåœ¨é¢å¯¹é«˜å¹¶å‘çš„æƒ…å†µæ—¶èƒ½å¤Ÿåˆç†çš„åˆ†ææ•°æ®åº“çš„è´Ÿè½½èƒ½åŠ›ã€‚</p><h2 id="æ•°æ®åº“ä¼˜åŒ–æ–¹å¼"><a href="#æ•°æ®åº“ä¼˜åŒ–æ–¹å¼" class="headerlink" title="æ•°æ®åº“ä¼˜åŒ–æ–¹å¼"></a>æ•°æ®åº“ä¼˜åŒ–æ–¹å¼</h2><h4 id="ä¼˜åŒ–ç›®æ ‡"><a href="#ä¼˜åŒ–ç›®æ ‡" class="headerlink" title="ä¼˜åŒ–ç›®æ ‡"></a>ä¼˜åŒ–ç›®æ ‡</h4><p>æ•°æ®åº“çš„ä¼˜åŒ–ä¸»è¦é’ˆå¯¹ä¸æŸ¥è¯¢ä¸­çš„æ…¢SQLï¼Œå¯ä»¥é€šè¿‡æ‰“å¼€é…ç½®æ–‡ä»¶ä¸­çš„è®°å½•æ…¢SQLåŠŸèƒ½ï¼Œé’ˆå¯¹æ…¢SQLè¿›è¡Œç»Ÿè®¡ï¼Œæ‰¾åˆ°æ…¢SQLåä½¿ç”¨explainå…³é”®å­—å¯¹SQLè¿›è¡Œè§£æï¼Œç»“æœä¸­çš„å…³é”®å­—æ®µåˆ†åˆ«æ˜¯typeï¼ˆè¿æ¥ç±»å‹ï¼‰ã€keyï¼ˆæŸ¥è¯¢æ—¶ä½¿ç”¨çš„ç´¢å¼•ï¼‰ã€rowsï¼ˆä¼°ç®—å‡ºæ¥çš„ç»“æœè¡Œæ•°ï¼‰ã€Extraï¼ˆæ‰§è¡Œæƒ…å†µè¯´æ˜ï¼‰ã€‚</p><p>å…¶ä¸­éœ€è¦é¢å¤–æ³¨æ„typeè¿”å›çš„ç»“æœï¼Œè¿”å›ç»“æœæœ‰ALLã€indexã€rangeã€ refã€eq_refã€constã€systemã€NULLï¼ˆæŒ‡å½“å‰æŸ¥è¯¢è¯­å¥çš„æ€§èƒ½ä»å·®åˆ°å¥½ï¼Œä¸€èˆ¬æ˜¯è®¤ä¸ºrangeåˆ™æ˜¯åˆæ ¼ï¼‰ï¼Œrowåˆ™æ˜¯å¯¹ç»“æœæ•°æ®æ¡æ•°çš„ä¼°ç®—ï¼Œè¯¥å€¼æ˜¯è¶Šå°è¶Šå¥½ã€‚Extraåˆ™æ˜¯å¯¹æŸ¥è¯¢ç»“æœçš„ä¸€ä¸ªè¯´æ˜ï¼Œå…¶ä¸­using whereåˆ™æ˜¯è¯´æ˜è¯¥æŸ¥è¯¢ä½¿ç”¨whereè¿›è¡Œç­›é€‰ï¼Œusing indexåˆ™æ˜¯è§¦å‘äº†ç´¢å¼•è¦†ç›–å³å½“å‰æŸ¥è¯¢å†…å®¹åªéœ€è¦æœç´¢ä¸€æ¬¡ç´¢å¼•æ ‘å³å¯æŸ¥åˆ°éœ€è¦çš„æ•°æ®ï¼Œusing index conditionåˆ™æ˜¯è§¦å‘å›è¡¨æ•ˆç‡è¾ƒä½ã€‚</p><h4 id="æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–"><a href="#æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–"></a>æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–</h4><p>æœ€å·¦åŒ¹é…åŸåˆ™ï¼šè¶Šé è¿‘whereçš„æ¡ä»¶ï¼Œä¼šè¶Šæœ‰é™å’Œç´¢å¼•åŒ¹é…ï¼Œå½“é‡åˆ°äº†èŒƒå›´æŸ¥è¯¢ï¼ˆ&gt;ã€&lt;ã€betweenï¼‰æˆ–è€…likeå…³é”®å­—æ—¶ï¼Œä¼šåœæ­¢å‘½ä¸­ç´¢å¼•ï¼Œå®é™…æ“ä½œä¸­å°†ç´¢å¼•ä¸€å¾‹é è¿‘whereæ¡ä»¶å³å¯ï¼›</p><p>ç´¢å¼•é€‰å–è§„èŒƒï¼šç´¢å¼•éœ€è¦åŒºåˆ†åº¦è¾ƒé«˜ï¼ŒåŒºåˆ†åº¦çš„è®¡ç®—å…¬å¼ä¸ºï¼ˆdistinct cloumnï¼‰/count(cloumn)ï¼Œæ¯”ç‡è¶Šå¤§åˆ™æ•°æ®è¶Šå°‘ï¼Œä¸€èˆ¬æ¨èå€¼ä¸º0.1ä»¥ä¸Šï¼›</p><p>å›è¡¨ï¼šç´¢å¼•åˆ—ä¸­æœªæŸ¥å‡ºselectä¸­æ‰€éœ€è¦çš„å­—æ®µéœ€è¦äºŒæ¬¡è¿›å…¥èšé›†ç´¢å¼•ï¼Œä¾æ®ä¸»é”®æŸ¥åˆ°æ•°æ®æºï¼Œç›¸å½“äºç»å†äº†ä¸¤æ¬¡B+æ ‘çš„æœç´¢ï¼Œæ•ˆç‡å¾ˆä½ä¸‹ï¼Œéœ€è¦é¿å…ï¼›ç´¢å¼•è¦†ç›–åˆ™æ˜¯é’ˆå¯¹å›è¡¨çš„ä¼˜åŒ–ï¼Œå°†æŸ¥è¯¢ä¸­æœªå‘½ä¸­çš„ç´¢å¼•å»ºç«‹è”åˆç´¢å¼•ï¼Œé¿å…ä¾æ®ç´¢å¼•æ— æ³•æŸ¥å‡ºå®Œæ•´æ•°æ®å¯¼è‡´çš„å›è¡¨ï¼›</p><p>ç´¢å¼•ä¸‹æ¨ï¼šMySQL5.6ä¼˜åŒ–åæŸ¥è¯¢ç´¢å¼•æ ‘æ—¶ä¼šå°†æ‰€æœ‰çš„whereåˆ¤æ–­ç´¢å¼•æ¡ä»¶éƒ½åŠ ä¸Šï¼ŒæŸ¥å‡ºç»“æœé›†ï¼Œå¦‚æœä¸ç¬¦åˆç»“æœåˆ™ç›´æ¥æ”¾å¼ƒè¯¥æ¡æ•°æ®ã€‚è€Œä¸æ˜¯åœ¨ä¹‹å‰ç‰ˆæœ¬ä¸­ä¼šæŸ¥å‡ºç¬¦åˆç¬¬ä¸€ä¸ªwhereæ¡ä»¶çš„ç»“æœå†ä¾æ¬¡ä½¿ç”¨whereæ¡ä»¶è¿›è¡Œå›è¡¨æŸ¥è¯¢ï¼›</p><p>ç´¢å¼•åˆå¹¶ï¼šMySQL5.1ä¼˜åŒ–åæŸ¥è¯¢å¯ä»¥ä½¿ç”¨å¤šä¸ªç´¢å¼•ä¸€èµ·ä½¿ç”¨ï¼›</p><p>joinåŸç†ï¼š<br>æœ€åŸºç¡€çš„ç´¢å¼•ï¼Œç­‰äºåŒé‡forå¾ªç¯ï¼Œå°†ä¸¤å¼ è¡¨çš„å†…å­˜è¿›è¡Œå¾ªç¯ç„¶åæŸ¥è¯¢ç»“æœé›†ã€‚<br>å½“joinä¸­çš„onæ¡ä»¶ä¸ºç´¢å¼•æ—¶ï¼Œä¼šå°†æœ€å¤–å±‚è¡¨çš„æ•°æ®æŸ¥è¯¢å‡ºæ¥åä½¿ç”¨ç´¢å¼•å»æŸ¥å†…å±‚è¡¨ï¼Œé¡¶å¤šåªéœ€è¦ä¸‰æ¬¡IOæŸ¥è¯¢ç´¢å¼•æ ‘å³å¯æŸ¥åˆ°ç»“æœï¼›<br>å½“joinä¸­çš„onæ¡ä»¶ä¸ä¸ºç´¢å¼•æ—¶ï¼Œä¼šè®©ä»»æ„ä¸€å¼ è¡¨ä½œä¸ºé©±åŠ¨è¡¨ï¼Œç„¶åå°†ç»“æœé›†å­˜å…¥join bufferï¼Œç„¶åä½¿ç”¨join bufferä¸­çš„å†…å®¹æ‰«æå¦ä¸€å¼ è¡¨ï¼›</p><p>joinä¼˜åŒ–ï¼š<br>å‡å°‘joinä¸­çš„æ¡ä»¶æ•°æ®ï¼Œå‡å°‘å¤šæ¬¡è¿æ¥ï¼ŒæŒ‰ç…§æœºå™¨æ€§èƒ½æ–°å¢join bufferå¤§å°ï¼›</p><h4 id="æ•°æ®åº“å­˜å‚¨ä¼˜åŒ–"><a href="#æ•°æ®åº“å­˜å‚¨ä¼˜åŒ–" class="headerlink" title="æ•°æ®åº“å­˜å‚¨ä¼˜åŒ–"></a>æ•°æ®åº“å­˜å‚¨ä¼˜åŒ–</h4><p>èƒ½ç”¨å°å­—æ®µå°½é‡ç”¨å°å­—æ®µï¼Œvarcharæ˜¯å˜é•¿çš„ï¼Œéšç€å­—æ®µå­˜å‚¨å†…å®¹çš„å˜å¤šä¼šå˜é•¿ã€‚ç¦æ­¢åœ¨æ•°æ®åº“å†…å­˜å‚¨æ–‡ä»¶ï¼Œå¦‚æœæœ‰éœ€è¦å­˜å‚¨æ–‡ä»¶çš„ä¸šåŠ¡æ—¶ï¼Œéœ€è¦æŠŠæ–‡ä»¶æ”¾å…¥æ–‡ä»¶æœåŠ¡å™¨ä¸­ä¾›ç³»ç»Ÿè®¿é—®å’Œä¸‹è½½ã€‚</p><h2 id="æ•°æ®åº“é”å’Œåˆ†å¸ƒå¼äº‹åŠ¡"><a href="#æ•°æ®åº“é”å’Œåˆ†å¸ƒå¼äº‹åŠ¡" class="headerlink" title="æ•°æ®åº“é”å’Œåˆ†å¸ƒå¼äº‹åŠ¡"></a>æ•°æ®åº“é”å’Œåˆ†å¸ƒå¼äº‹åŠ¡</h2><h4 id="é”"><a href="#é”" class="headerlink" title="é”"></a>é”</h4><p>æ•°æ®åº“é”ä¸€èˆ¬æ˜¯è¯»å†™é”ï¼Œè¯»é”ååªèƒ½åŠ è¯»é”ï¼Œä¸èƒ½åŠ å†™é”ã€‚åŠ äº†å†™é”åå…¶ä»–ä»»ä½•è¯»é”ã€å†™é”éƒ½æ— æ³•åŠ å…¥ï¼Œä½¿ç”¨äº†MVCCæœºåˆ¶è¿›è¡Œäº†ä¼˜åŒ–ï¼›</p><p>InnoDBï¼šæœ‰è¡Œé”å’Œè¡¨é”ï¼Œæœ‰ç´¢å¼•åˆ™è§¦å‘è¡Œé”ï¼Œæ²¡æœ‰åˆ™æ˜¯è¡¨é”ï¼›<br>MyISAMï¼šåªæœ‰è¡¨é”ï¼›</p><h4 id="äº‹åŠ¡"><a href="#äº‹åŠ¡" class="headerlink" title="äº‹åŠ¡"></a>äº‹åŠ¡</h4><p>äº‹ç‰©çš„å››å¤§ç‰¹å¾ACIDï¼Œåœ¨InnoDBä¸­ï¼š</p><blockquote><p>åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šä½¿ç”¨undo logæ¥å®ç°ï¼›</p><p>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šä½¿ç”¨Aã€Iã€Dé…åˆå®ç°ï¼›</p><p>éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šä½¿ç”¨æ•°æ®åº“ä¸­çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ¥å®ç°ï¼›</p><p>æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šä½¿ç”¨redo logæ¥å®ç°ï¼›</p></blockquote><p>äº‹åŠ¡éš”ç¦»çº§åˆ«</p><ul><li>è¯»æœªæäº¤ï¼šè¯»åˆ°å¯¹æ–¹æœªæäº¤çš„äº‹åŠ¡ï¼›</li><li>è¯»å·²æäº¤ï¼šä¸¤æ¬¡è¯»çš„å†…å®¹ä¸åŒï¼Œç¬¬äºŒæ¬¡è¯»åˆ°çš„äº‹åŠ¡ä¸ºå·²æäº¤çš„å†…å®¹ï¼Œä¹Ÿå«ä¸å¯é‡å¤è¯»ï¼›</li><li>å¯é‡å¤è¯»ï¼šä¸¤æ¬¡è¯»çš„å†…å®¹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ— è®ºç¬¬äºŒæ¬¡äº‹åŠ¡æœ‰æ²¡æœ‰æäº¤ï¼Œåªè¦å½“å‰äº‹åŠ¡æœªæäº¤ï¼Œå°±åªèƒ½è¯»å–å½“å‰äº‹åŠ¡çš„æ•°æ®ï¼›</li><li>å¹»è¯»ï¼šç¬¬ä¸€æ¬¡åªæŸ¥è¯¢åˆ°ä¸€æ¡æ•°æ®ä½†æ˜¯ç¬¬äºŒæ¬¡æŸ¥è¯¢æŸ¥åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡æäº¤çš„æ•°æ®ï¼›</li><li>ä¸²è¡ŒåŒ–ï¼šäº‹åŠ¡ä¹‹é—´äº’æ–¥ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªäº‹åŠ¡æäº¤ååç»­äº‹åŠ¡æ‰èƒ½ä¾æ¬¡æ‰§è¡Œã€‚</li></ul><p>MVCCï¼šmysql innodbå­˜å‚¨å¼•æ“é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯å¯é‡å¤è¯»ï¼Œmysqlå®ç°å¯é‡å¤è¯»ä½¿ç”¨çš„æ˜¯mvccæœºåˆ¶(å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶)ã€‚å°±æ˜¯åœ¨è¯»çš„æ—¶å€™éƒ½åŠ ä¸Šç‰ˆæœ¬å·ï¼Œåªæœ‰å½“å…¶ä»–äº‹åŠ¡æäº¤åï¼Œæ‰æ›´æ–°æœ€æ–°çš„ç‰ˆæœ¬å·ï¼Œå®ç°åŸç†æ˜¯ä½¿ç”¨undo logã€‚</p><p>åˆ†å¸ƒå¼äº‹åŠ¡</p><ol><li><p>CAPå®šç†ï¼š</p><ul><li><p>C - Consistencyï¼Œä¸€è‡´æ€§</p></li><li><p>A - Availabilityï¼Œå¯ç”¨æ€§</p></li><li><p>P - Partition toleranceï¼Œåˆ†åŒºå®¹å¿æ€§</p></li></ul><p> CAPå®šç†ï¼Œç”±äºåˆ†å¸ƒå¼çš„å­˜åœ¨ï¼Œæ‰€ä»¥åœ¨ä¸‰ä¸ªç‰¹æ€§ä¸­å¿…é¡»æ»¡è¶³Pï¼Œå³åˆ†åŒºå®¹å¿æ€§ï¼Œåœ¨ä¸åŒçš„ç½‘ç»œç¯å¢ƒä¸­çš„äº’ç›¸é€šè®¯çš„èŠ‚ç‚¹æœåŠ¡æ­»äº¡åä¸ä¼šå½±å“å…¶ä»–æœåŠ¡ã€‚è€ŒAå’ŒCä¸èƒ½å…±å­˜ï¼Œåˆ™è¡ç”Ÿå‡ºæ¥äº†APã€CPä¸¤ç§æƒ…å†µã€‚</p><p> CPï¼šæœåŠ¡å’ŒæœåŠ¡ä¹‹é—´ä¿è¯äº†é«˜å¼ºåº¦çš„ä¸€è‡´æ€§ï¼Œå¦‚æœæœ‰æœåŠ¡æ­»äº¡åˆ™é€šè¿‡æŠ•ç¥¨æˆ–é€‰ä¸¾ç­‰æªæ–½ç­‰å¾…æ•°æ®åŒæ­¥ï¼ŒæœåŠ¡ä¼šæœ‰éƒ¨åˆ†æ—¶é—´ä¸å¯ç”¨ï¼›</p><p> APï¼šæœåŠ¡å’ŒæœåŠ¡ä¹‹é—´ä¸ºäº†ä¿è¯å¯ä»¥å¯¹å¤–æä¾›è®¿é—®åˆ™ä¼šï¼Œä¸å…³æ³¨å¤šå°æœåŠ¡ä¸Šçš„æ•°æ®æ˜¯å¦åŒæ­¥çš„æƒ…å†µï¼›</p></li><li><p>XAè§„èŒƒï¼š</p><ul><li>APï¼šappliaction åº”ç”¨ç¨‹åº</li><li>TMï¼štruncation manager äº‹åŠ¡ç®¡ç†å™¨</li><li>RMï¼šresource manager èµ„æºç®¡ç†å™¨</li><li>CRMï¼šcommunication resource manager é€šè®¯èµ„æºç®¡ç†å™¨</li></ul></li><li><p>è§£å†³æ–¹æ¡ˆ</p><ul><li>2PCæ–¹æ¡ˆ</li><li>3PCæ–¹æ¡ˆ</li><li>TCCæ–¹æ¡ˆ</li><li>æœ¬åœ°æ¶ˆæ¯è¡¨æ–¹æ¡ˆ</li><li>æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆ</li><li>æœ€å¤§åŠªåŠ›é€šçŸ¥æ–¹æ¡ˆ</li></ul></li></ol><h2 id="åˆ†åº“åˆ†è¡¨"><a href="#åˆ†åº“åˆ†è¡¨" class="headerlink" title="åˆ†åº“åˆ†è¡¨"></a>åˆ†åº“åˆ†è¡¨</h2><h4 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><blockquote><p>åˆ†è€Œæ²»ä¹‹ï¼Œå°†å¤§è§„æ¨¡çš„æ•°æ®æŒ‰ç…§æŸç§è§„å¾‹è¿›è¡Œåˆ’åˆ†ï¼Œå‚ç›´åˆ†è¡¨åº”è¯¥åœ¨è®¾è®¡è¡¨çš„æ—¶å€™æ ¹æ®ä¸šåŠ¡éƒ½åˆ’åˆ†å®Œæ¯•ï¼Œæ‰€ä»¥æ¶æ„ä¸­éœ€è¦å¤„ç†çš„åˆ†è¡¨ä¸»è¦ä¸ºæ°´å¹³åˆ†è¡¨</p></blockquote><h4 id="ç›¸å…³å®ç°"><a href="#ç›¸å…³å®ç°" class="headerlink" title="ç›¸å…³å®ç°"></a>ç›¸å…³å®ç°</h4><p>mysqlåˆ†åŒºè¡¨è¯­æ³• PARTITION BY RANGEï¼Œå»ºè®®åˆ†åŒºåˆ—ä¸ºå¯é˜¶æ®µæ€§æ‹†åˆ†åˆ—ï¼Œä¾‹å¦‚æ—¶é—´ï¼Œå¹´é¾„ï¼Œç±»åˆ«ä¹‹ç±»ï¼Œä½¿ç”¨sharding jdbcè¿›è¡Œåˆ†åº“åˆ†è¡¨</p><h2 id="é«˜å¯ç”¨"><a href="#é«˜å¯ç”¨" class="headerlink" title="é«˜å¯ç”¨"></a>é«˜å¯ç”¨</h2><h4 id="è¯»å†™åˆ†ç¦»"><a href="#è¯»å†™åˆ†ç¦»" class="headerlink" title="è¯»å†™åˆ†ç¦»"></a>è¯»å†™åˆ†ç¦»</h4><ul><li><input disabled="" type="checkbox"> å¾…å®Œæˆ</li></ul><h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><h4 id="æ“ä½œç³»ç»Ÿç›¸å…³çŸ¥è¯†"><a href="#æ“ä½œç³»ç»Ÿç›¸å…³çŸ¥è¯†" class="headerlink" title="æ“ä½œç³»ç»Ÿç›¸å…³çŸ¥è¯†"></a>æ“ä½œç³»ç»Ÿç›¸å…³çŸ¥è¯†</h4><ul><li><input disabled="" type="checkbox"> å¾…å®Œæˆ</li></ul><h4 id="Dockeréƒ¨ç½²ç›¸å…³å¸¸è§é—®é¢˜ç‚¹"><a href="#Dockeréƒ¨ç½²ç›¸å…³å¸¸è§é—®é¢˜ç‚¹" class="headerlink" title="Dockeréƒ¨ç½²ç›¸å…³å¸¸è§é—®é¢˜ç‚¹"></a>Dockeréƒ¨ç½²ç›¸å…³å¸¸è§é—®é¢˜ç‚¹</h4><ol><li>æ—¶åŒºéœ€è¦è°ƒæ•´åˆ°ä¸Šæµ·</li><li>é»˜è®¤å¼€å¯äº†å¤§å°å†™æ ¡éªŒï¼Œå¯æŒ‰éœ€æ›´æ”¹</li></ol><h4 id="æ•°æ®åº“è¿æ¥æ± "><a href="#æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="æ•°æ®åº“è¿æ¥æ± "></a>æ•°æ®åº“è¿æ¥æ± </h4><ol><li>navicatè¿æ¥æ•°æ®åº“éœ€è¦æŠŠä¿æŒè¿æ¥é—´éš”é™ä½åˆ°30sï¼Œé»˜è®¤æ—¶é•¿ä¸º240sï¼Œä¼šå¯¼è‡´å“åº”æ—¶é—´è¿‡é•¿å¯¼è‡´æ•°æ®åº“è¿æ¥è¢«é‡Šæ”¾æ‰</li></ol><ul><li><input disabled="" type="checkbox"> å¾…å®Œæˆ</li></ul><p>å‚è€ƒæ–‡çŒ®ï¼š<br><a href="https://tech.meituan.com/2014/06/30/mysql-index.html">ã€ŠMySQLç´¢å¼•åŸç†åŠæ…¢æŸ¥è¯¢ä¼˜åŒ–ã€‹</a>- ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ</p>]]></content>
      
      
      
        <tags>
            
            <tag> MySQL </tag>
            
            <tag> åç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
